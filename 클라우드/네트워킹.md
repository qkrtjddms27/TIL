# 네트워킹

> Amazon Virtual Private Cloud 줄여서 VPC라고 부릅니다 VPC를 사용하면 사용자가 정의한 가상 네트워크에서 AWS 리소스를 실행할 수 있는
> 논리적으로 격리된 AWS 클라우드 섹션을 프로비저닝 할 수 있습니다.

## VPC
> Virtual Private Cloud는 AWS에서 사용할 수 있는 가상의 격리된 프라이빗 네트워크.

- VPC를 사용하면 AWS 리소스용 IP 범위를 정의할 수 있다.
- VPC에 EC2 인스턴스나 ELB와 같은 요소를 배치할 수 있다.
  + 바로 두는 것이 아니라 서브넷을 두고 VPC 내에 있는 IP 주소의 모음으로 리소스를 그룹화할 수 있게 도와줌.
  + 서브넷은 나중에 살펴볼 네트워킹 규칙을 이용해서 리소스를 공개할지 혹은 공개하지 않을지를 제어하게 된다.

- VPC에 들어갈 수 있는 인바운드 트래픽을 제어하는 방법들도 다양하다.
  + 일부 VPC에는 공개 웹 사이트와 같은 공객적으로 접근할 수 있는 인터넷 연결 리소스가 존재.
  + 프라이빗 네트워크 VPC에 로그인한 사람만 접근해야 되는 리소스가 존재할 때도 많다.
  + HR 애플리케이션이나 백엔드 데이터베이스와 같은 내부 서비스.

### 프라이빗 리소스
- 어디에서 왔느냐에 관계업싱 누구도 이 리소스에 접근하게 해서는 안된다.
  + 단, 공개 인터넷이 아닌 승인된 네트워크에서 오는 사람은 허용을 해야 되기 때문에 이것을 허용하는 `프라이빗 게이트위이`가 필요하다.
    * 이러한 비공개 출입구를 가상 프라이빗 게이트웨이라고 하고 이것으로 온프레미스 데이터 센터나 사내 네트워크 같은 프라이빗 네트워크와 VPC 간에 VPN 연결을 만들 수 있다.

### Direct Connect
- AWS로 이어지는 완전히 비공개인 전용 광섬유 회선을 구축할 수 있다
- Direct Connect는 네트워크와 AWS VPC를 연결하는 물리적인 회선을 제공하기 때문.

## Amazon Virtual Private Cloud, VPC
> AWS 서비스를 사용하는 수백만의고객이 생성한 Amazon EC2 인스턴스와 같은 수백만 개의 리소스가 경계가 없으면 
> 네트워크 트래픽이 제한 없이 리소스 간에 흐를 수 있다.
> AWS 리소스에 경계를 설정하는 데 사용할 수 있는 네트워킹 서비스가 Amazon Virtual Private Cloud

- Amazon VPC를 사용하여 AWS 클라우드의 격리된 섹션을 프로비저닝할 수 있습니다. 한 Virtual Private Cloud 내에서 여러 서브넷으로 리소스를 구성할 수 있습니다.

## 인터넷 게이트웨이
> 인터네스이 퍼블랙 트래픽이 VPC에 액세스하도록 허용하려면 인터넷 게이트웨이를 VPC에 연결합니다.
- 인터넷 게이트웨이는 VPC와 인터넷 간의 연결입니다.
- 인터넷 게이트웨이는 고객이 커피숍에 들어가기 위해 사용하는 출입문과 비슷합니다.
- 인터넷 게이트웨이가 없으면 아무도 VPC 내의 리소스에 액세스할 수 없습니다.

## 가상 프라이빗 게이트웨이
> VPC 내의 비공개 리소스에 액세스하려면 가상 프라이빗 게이트웨이를 사용할 수 있습니다.
- 가상 프라이빗 게이트웨이는 승인된 네트워크에서 나오는 트래픽만 VPC로 들어가도록 허용합니다.
- 패킷은 인터넷에 보내는 메시지이며 서브넷 경계를 지나는 모든 패킷은 네트워크 액세스 제어 목록, 즉 네트워크 ACl에서 검사됩니다.
- 발신자와 통신 프로토콜을 기준으로 패킷이 서브넷에 출입할 수 있는 권한이 있는지 확인하기 위함입니다.
- 인바운드에 성공했다고 해서 아웃바운드가 무조건 허용되진않는다.

## 서브넷
> 서브넷은 보안 또는 운영 요구 사항에 따라 리소스를 그룹화할 수 있는 VPC 내의 한 섹션입니다.
> 서브넷은 퍼블릭 또는 프라이빗일 수 있습니다.

### 퍼블릭 서브넷
- 온라인 상점의 웹 사이트와 같이 누구나 액세스할 수 있어야 하는 리소스가 포함됨

### 프라이빗 서브넷
- 고객의 개인 정보 및 주문 내역이 포함된 데이터베스와 같이 프라이빗 네트워크를 통해서만 액세스할 수 있는 리소스가 포함됨

> VPC 내에서 서브넷은 서로 통신할 수 있습니다. 예를 들어 퍼블릭 서브넷에 있는 Amazon EC2 인스턴스가 프라이빗 서브넷에 있는 데이터베이스와 통신하는 애플리케이션이 있을 수 있습니다.

## ACL
> 계정의 기본 네트워크 ACL은 기본적으로 모든 인바운드 및 아웃바운드 트래픽을 허용하지만 사용자가 자체 규칙을 추가하여 수정할 수 있습니다.
- 네트워크 ACL은 상태 비저장 패킷 필터링을 수행합니다.
- 아무것도 기억하지 않고 각 방향으로 서브넷 경계를 통과하는 패킷만 확인

## 보안 그룹
> 보안 그룹은 Amazon EC2 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어하는 가상 방화벽
- 기본적으로 모든 인바운드 트래픽을 거부하고 모든 아웃바운드 트래픽을 허용합니다.
- 서브넷 내에 여러 Amazon Ec2 인스턴스가 있는 경우 동일한 보안 그룹에 연결하거나 각 인스턴스마다 서로 다른 보안 그룹을 사용할 수 있습니다.

### 상태 저장 패킷 필터링
- 보안 그룹은 상태 저장 패킷 필터링을 수행합니다. 즉, 들어오는 패킷에 대한 이전 결정을 기억
- EC2 인스턴스에서 인터넷으로 요청을 전송하는 것과 동일한 예
  + 보안 그룹이 이전 요청을 기억하고 보안 그룹 규칙에 관계없이 응답이 진행하도록 허용