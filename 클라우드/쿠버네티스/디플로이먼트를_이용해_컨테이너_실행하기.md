# 디플로이먼트를 이용해 컨테이너 실행하기

> 쿠버네티스를 이용해서 컨테이너를 실행하는 방법에는 크게 두 가지가 있습니다. 하나는 kubectl run 명령으로 직접 컨테이너를 실행하는 것이고 
> 다른 하나는 컨테이너를 어떻게 실행할지 세부 내용을 담은 YAML 형식의 템플릿으로 컨테이너를 실행하는 것입니다.

## kubectl run으로 컨테이너 실행하기
- kubectl run으로 파드를 실행시킬 때 기본 컨트롤러는 디플로이먼트.
- kubectl run 디플로이머트 이름 --image 컨테이너이미지이름 --port=포트번호 명령을 실행합니다.

---

```
$ kubectl runb nginx-app --image nginx --port=80
```
- kubectl run 명령 다음에 생성하려는 디플로이먼트 이름을 입력하고 --image 옵션에 실행할 컨테이너 이름을 입력합니다.
- 컨테이너가 제대로 실행됐는지 확인하는 명령어는 kubectl get pods
- 디플로이먼트의 상태를 확인하는 명령어는 kubectl get deployments
  + NAME : 클러스터에 배포한 디플로이먼트 이름.
  + READY : 사용자가 최종 배포한 파드 개수와 디플로이먼트를 이용해 현재 클러스터에 실제로 동작시킨 파드 개수를 X/X 현태로 표시.
  + UP-TO-DATE : 디플로이먼트 설정에 정의한 대로 동작 중인 신규 파드 개수
  + AVAILABLE : 서비스 가능한 파드 개수입니다.
  + AGE : 디플로이먼트를 생성한 후 얼마나 지났는지 시간을 나타냄.

```
$ kubectl get deployments
```
- NAME : 클러스터에 배포한 디플로이먼트
- READY : 사용자가 최종 배포한 파드 개수와 디플로이먼트를 이용해 현재 클러스터에 실제로 동작시킨 파드 개수를 X/X 형태로 표시
  + 디플로이먼트를 새로 생성하거나 디플로이먼트 설정을 변경했다면 새로운 버전의 파드를 배포.
  + X에서 표시하는 파드 개수보다 뒤의 X에서 파드 개수가 더 많거나 적을 수 있습니다.
- UP-TO-DATE : 디플로이먼트 설정에 정의한 대로 동작 중인 신규 파드 개수.
- AVAILABLE : 서비스 가능한 파드 개수.
  + 파드를 실행한 후 설정된 헬스 체크로 서비스 가능한 상태라고 판단하면 AVAILABLE 항목의 파드 개수의 포함.
- AGE : 디플로이먼트를 생성한 후 얼마나 지났는지 시간을 나타냄.

### 디플로이먼트
> 파드와 레플리카셋에 대한 선언적 업데이트를 제공한다.

 ```
$ kubectl scale deploy nginx-app --replica=2
 ```

```
$ kubectl get deploymentes

$ kubectl get pods
```

### 클러스터 외부에서 클러스터 안 앱에 접근하기
- 쿠버네티스 내부에서 실행한 컨테이너를 외부에서 접근하려면 쿠버네티스의 서비스를 사용해야 한다.
- 서비스 타입에는 ClusterIP, NodePort, LoadBalancer, ExternalName이 있다.
```
$ kubectl get service
```


