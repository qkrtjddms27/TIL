# Application Load Balancer

> 둘 이상의 가용 영역에서 EC2 인스턴스, 컨테이너, IP 주소 등 여러 대상에 걸쳐 수신되는 트래픽을 자동으로 분산.
> 등록된 대상의 상태를 모니터링하면서 상태가 양호한 대상으로만 트래픽을 라우팅

- Elastic Load Balancing은 여러 로드 밸런서를 지원.
  + Application Load Balancers
  + Network Laod Balacners
  + Gateway Load Balancer

## Application Load Balancer

- 클라이언트의 단일 접점 역할을 수행.
- 7계층에서 로드밸런싱
- EC2 인스턴스 같은 여러 대상에 수신 애플리케이션 트래픽을 분산.
- `리스너`는 구성한 프로토콜 및 포트를 사용하여 클라이언트의 연결 요청을 확인
  + 리스너에 대해 정의한 규칙에 따라 로드 밸런서가 등록된 대상으로 요청을 라우팅하는 방법이 결정됨.
- 각 규칙은 우선순위, 하나 이상의 작업, 하나 이사으이 조건으로 구성.
  + 규칙에 대한 조건이 충족되면 작업이 수행.
  + 각 리스너에 대한 기본 규칙을 정의해야 하며, 필요에 따라 추가 규칙을 정의할 수 있음.
- 애플리케이션 트래픽의 콘텐츠를 기반으로 다른 대상 그룹에 요청을 라우팅하도록 리스너 귤칙을 구성할 수 있음.
- 애플리케이션에 대하 요청의 전체적인 흐름을 방해하지 않고 필요에 따라 로드 밸런서에서 대상을 추가 및 제거할 수 있음.
- 트래픽이 시간에 따라 변화하므로 Elastic Load Balancing은 로드 밸런서를 확장

### Classic Load Balancer에서 마이그레이션 할 때의 이점
> Classic Load Balancer 대신 Application Load Balancer를 사용하면 다음과 같은 이점이 있습니다.

- 경로 조건에 대한 지원
  + URL을 기반으로 요청을 전달하는 리스너에 대한 규칙을 규정할 수 있음.
  + 이를 통해 애플리케이션의 규모를 더욱 작은 서비스로 구성할 수 있다.
    * 확장성과 안전성을 얻을 수 있는 방법

- 호스트 조건에 대한 지원
  + HTTP 헤더의 호스트 필드를 기반으로 요청을 전달하는 리스너에 대한 규칙을 구성할 수 있음.
  + 따라서 단일 로드 밸런서를 사용하여 여러 개의 도메인에 요청을 라우팅 할 수 있음.

- HTTP 헤더 조건 및 메서드
  + 쿼리 파라미터, 소스 IP 주소 등 요청의 필드를 기반으로 하는 라우팅을 지원.

-단일 EC2 인스턴스의 여러 애플리케이션으로 요청을 라우팅하는 것을 지원.

- 한 URL에서 다른 URL로 요청을 리다이렉션하는 작업을 지원
- 로드 밸런서의 VPC 외부 대상을 포함하여 IP 주소로 대상을 등록하는 것을 지원.
- Lambda 함수를 대상으로 등록하는 작업을 지원.
- 요청을 라우팅 하기전에 기업 또는 소셜 자격 증명을 한다.
- 상태 확인은 대상 그룹 수준에서 정의되고 많은 CloudWatch 지표가 대상 그룹 수준에서 보고되므로 각 서비스의 상태를 독립적으로 모니터링 가능
- Auto Scaling 그룹에 대상 그룹을 연결하면 필요에 따라 동적으로 각 서비스를 확장할 수 있음.

## Network Load Balancer

- 4 계층에서 작동
- 초당 수백만 개의 요청을 처리할 수 있다.
- 수신기 구성에 지정된 포트에서 선택한 대상에 대한 TCP 연결을 열려고 시도.

### Classic Load Balancer에서 마이그레이션 할 때의 이점

- 휘발성 워크로드를 처리하고 초당 수백만 개의 요청을 확장할 수 있는 기능
- 로드 밸런서의 고정 IP 주소 지원.로드 밸런서에 대해 활성화된 서브넷당 하나의 탄력적 IP 주소를 할당할 수도 있다.
- 로드 밸런서를 위한 VPC 외부의 대상을 포함하여 IP 주소로 대상을 등록하는 것을 지원
- 단일 EC2 인스턴스에서 여러 애플리케이션으로 요청 라우팅을 지원
- 컨테이너화된 애플리케이션을 지원.
